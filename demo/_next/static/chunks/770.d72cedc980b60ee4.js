(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{6770:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(6729),i=n.n(r),o=n(8155),s=n(9054),a=n.n(s),d=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{d(r.next(e))}catch(t){o(t)}}function a(e){try{d(r.throw(e))}catch(t){o(t)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((r=r.apply(e,t||[])).next())}))};class c extends(i()){constructor(e,t){if(super(),this._network=t,this._publicKey=null,this._popup=null,this._handlerAdded=!1,this._nextRequestId=1,this._autoApprove=!1,this._responsePromises=new Map,this.handleMessage=e=>{var t;if(this._injectedProvider&&e.source===window||e.origin===(null===(t=this._providerUrl)||void 0===t?void 0:t.origin)&&e.source===this._popup)if("connected"===e.data.method){const t=new o.nh(e.data.params.publicKey);this._publicKey&&this._publicKey.equals(t)||(this._publicKey&&!this._publicKey.equals(t)&&this.handleDisconnect(),this._publicKey=t,this._autoApprove=!!e.data.params.autoApprove,this.emit("connect",this._publicKey))}else if("disconnected"===e.data.method)this.handleDisconnect();else if(e.data.result||e.data.error){const t=this._responsePromises.get(e.data.id);if(t){const[n,r]=t;e.data.result?n(e.data.result):r(new Error(e.data.error))}}},this._beforeUnload=()=>{this.disconnect()},function(e){return"object"===typeof e&&null!==e}(n=e)&&"postMessage"in n&&"function"===typeof n.postMessage)this._injectedProvider=e;else{if(!function(e){return"string"===typeof e}(e))throw new Error("provider parameter must be an injected provider or a URL string.");this._providerUrl=new URL(e),this._providerUrl.hash=new URLSearchParams({origin:window.location.origin,network:this._network}).toString()}var n}handleConnect(){var e;return this._handlerAdded||(this._handlerAdded=!0,window.addEventListener("message",this.handleMessage),window.addEventListener("beforeunload",this._beforeUnload)),this._injectedProvider?new Promise((e=>{this.sendRequest("connect",{}),e()})):(window.name="parent",this._popup=window.open(null===(e=this._providerUrl)||void 0===e?void 0:e.toString(),"_blank","location,resizable,width=460,height=675"),new Promise((e=>{this.once("connect",e)})))}handleDisconnect(){this._handlerAdded&&(this._handlerAdded=!1,window.removeEventListener("message",this.handleMessage),window.removeEventListener("beforeunload",this._beforeUnload)),this._publicKey&&(this._publicKey=null,this.emit("disconnect")),this._responsePromises.forEach((([,e],t)=>{this._responsePromises.delete(t),e(new Error("Wallet disconnected"))}))}sendRequest(e,t){return d(this,void 0,void 0,(function*(){if("connect"!==e&&!this.connected)throw new Error("Wallet not connected");const n=this._nextRequestId;return++this._nextRequestId,new Promise(((r,i)=>{var o,s,a,d;this._responsePromises.set(n,[r,i]),this._injectedProvider?this._injectedProvider.postMessage({jsonrpc:"2.0",id:n,method:e,params:Object.assign({network:this._network},t)}):(null===(o=this._popup)||void 0===o||o.postMessage({jsonrpc:"2.0",id:n,method:e,params:t},null!==(a=null===(s=this._providerUrl)||void 0===s?void 0:s.origin)&&void 0!==a?a:""),this.autoApprove||null===(d=this._popup)||void 0===d||d.focus())}))}))}get publicKey(){return this._publicKey}get connected(){return null!==this._publicKey}get autoApprove(){return this._autoApprove}connect(){return d(this,void 0,void 0,(function*(){this._popup&&this._popup.close(),yield this.handleConnect()}))}disconnect(){return d(this,void 0,void 0,(function*(){this._injectedProvider&&(yield this.sendRequest("disconnect",{})),this._popup&&this._popup.close(),this.handleDisconnect()}))}sign(e,t){return d(this,void 0,void 0,(function*(){if(!(e instanceof Uint8Array))throw new Error("Data must be an instance of Uint8Array");const n=yield this.sendRequest("sign",{data:e,display:t});return{signature:a().decode(n.signature),publicKey:new o.nh(n.publicKey)}}))}signTransaction(e){return d(this,void 0,void 0,(function*(){const t=yield this.sendRequest("signTransaction",{message:a().encode(e.serializeMessage())}),n=a().decode(t.signature),r=new o.nh(t.publicKey);return e.addSignature(r,n),e}))}signAllTransactions(e){return d(this,void 0,void 0,(function*(){const t=yield this.sendRequest("signAllTransactions",{messages:e.map((e=>a().encode(e.serializeMessage())))}),n=t.signatures.map((e=>a().decode(e))),r=new o.nh(t.publicKey);return e=e.map(((e,t)=>(e.addSignature(r,n[t]),e)))}))}diffieHellman(e){return d(this,void 0,void 0,(function*(){if(!(e instanceof Uint8Array))throw new Error("Data must be an instance of Uint8Array");return yield this.sendRequest("diffieHellman",{publicKey:e})}))}}},4738:function(e,t,n){"use strict";var r=n(9509).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==t[s])throw new TypeError(o+" is ambiguous");t[s]=i}var a=e.length,d=e.charAt(0),c=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function u(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return r.alloc(0);for(var n=0,i=0,o=0;e[n]===d;)i++,n++;for(var s=(e.length-n)*c+1>>>0,h=new Uint8Array(s);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var l=0,p=s-1;(0!==u||l<o)&&-1!==p;p--,l++)u+=a*h[p]>>>0,h[p]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");o=l,n++}for(var f=s-o;f!==s&&0===h[f];)f++;var v=r.allocUnsafe(i+(s-f));v.fill(0,0,i);for(var w=i;f!==s;)v[w++]=h[f++];return v}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=r.from(t)),!r.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var n=0,i=0,o=0,s=t.length;o!==s&&0===t[o];)o++,n++;for(var c=(s-o)*h+1>>>0,u=new Uint8Array(c);o!==s;){for(var l=t[o],p=0,f=c-1;(0!==l||p<i)&&-1!==f;f--,p++)l+=256*u[f]>>>0,u[f]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");i=p,o++}for(var v=c-i;v!==c&&0===u[v];)v++;for(var w=d.repeat(n);v<c;++v)w+=e.charAt(u[v]);return w},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},9054:function(e,t,n){var r=n(4738);e.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")}}]);